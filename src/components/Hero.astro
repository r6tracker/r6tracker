---
import { useTranslations, type Lang } from "@/i18n";
const t = useTranslations(Astro.currentLocale as Lang);

const JsonData = `
{
    "h1": {
        "en": "Rainbow Six Siege Stats Tracker - Analyze Your R6 Performance",
        "it": "Tracker Statistiche Rainbow Six Siege - Analizza le tue Prestazioni R6",
        "de": "Rainbow Six Siege Statistiken Tracker - Analysiere deine R6 Leistung"
    },
    "h2":{
        "en": "Comprehensive Rainbow Six Siege statistics platform for competitive players. Track your K/D ratio, win rate, operator performance, and match history with real-time R6 stats analytics. Improve your Siege gameplay with detailed performance metrics and competitive insights.",
        "it": "Piattaforma completa di statistiche Rainbow Six Siege per giocatori competitivi. Monitora il tuo rapporto K/D, percentuale vittorie, prestazioni operatori e cronologia partite con analisi statistiche R6 in tempo reale. Migliora il tuo gameplay Siege con metriche dettagliate delle prestazioni e approfondimenti competitivi.",
        "de": "Umfassende Rainbow Six Siege Statistikplattform für wettbewerbsorientierte Spieler. Verfolge dein K/D-Verhältnis, Gewinnrate, Operator-Leistung und Spielverlauf mit Echtzeit-R6 Statistikanalysen. Verbessere dein Siege Gameplay mit detaillierten Leistungsmetriken und wettbewerbsorientierten Einblicken."
    },
    "placeholder": {
        "en": "Enter Ubisoft Username",
        "it": "Inserisci Nome Utente Ubisoft", 
        "de": "Gib Ubisoft Benutzernamen ein"
    },
    "button": {
        "en": "Track My R6 Stats Now",
        "it": "Monitora le mie Statistiche R6 Ora",
        "de": "Verfolge meine R6 Statistiken Jetzt"
    }
}
`;

const data = JSON.parse(JsonData);
---

<section id="track-button" class="relative overflow-hidden py-20 sm:py-24 md:py-32">
    <div class="container px-4 sm:px-6">
        <div class="mx-auto flex max-w-5xl flex-col items-center">
            <div class="z-10 flex flex-col items-center gap-6 text-center w-full">
                <div class="w-full">
                    <h1 class="mb-4 sm:mb-6 text-pretty text-xl sm:text-2xl md:text-4xl lg:text-5xl font-bold">
                        {t(data.h1)}
                    </h1>
                    <p class="text-zinc-600 text-base sm:text-lg md:text-xl">
                        {t(data.h2)}
                    </p>
                </div>
                <div class="mt-4 flex flex-col sm:flex-row w-full justify-center gap-2 sm:gap-2">
                    <select
                        class="h-10 px-4 rounded-md bg-zinc-900 text-white border border-zinc-700 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 transition-colors w-full sm:w-auto
                        dark:bg-zinc-800 dark:text-white dark:border-zinc-600"
                    >
                        <option value="ubisoft">Ubisoft</option>
                        <option value="playstation">PlayStation</option>
                        <option value="xbox">Xbox</option>
                    </select>
                    <input
                        type="text"
                        placeholder={t(data.placeholder)}
                        class="h-10 px-4 rounded-md bg-zinc-900 text-white border border-zinc-700 w-full sm:w-80 focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 transition-colors
                        dark:bg-zinc-800 dark:text-white dark:border-zinc-600"
                    />
                    <button name="goBtn"
                        class="inline-flex items-center justify-center whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-zinc-900 text-white hover:bg-zinc-900/90 h-10 px-4 py-2 w-full sm:w-auto
                        dark:bg-zinc-800 dark:text-white dark:hover:bg-zinc-700"
                    >
                        {t(data.button)}
                    </button>
                </div>
            </div>
        </div>
    </div>
</section>
<script is:inline>

    const goBtn = document.querySelector("#track-button button[name='goBtn']");
    document.addEventListener('keydown', (e) => {
        if (e.key === 'Enter') {
        e.preventDefault();
        goBtn.click(); // 手动触发 click 事件
        }
    });
    document
        .querySelector("#track-button button")
        .addEventListener("click", function () {
            const platform = document.querySelector(
                "#track-button select",
            ).value;
            const username = document
                .querySelector('#track-button input[type="text"]')
                .value.trim();
            if (username) {
                let platformPath =
                    platform === "playstation"
                        ? "psn"
                        : platform === "xbox"
                          ? "xbl"
                          : "uplay";
                window.location.href = `https://r6.tracker.network/r6siege/profile/${platformPath}/${encodeURIComponent(username)}/overview`;
            }
        });
</script>
